<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>TSB Data Viz</title>
<style type="text/css">
text {
  font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif;
  font-size: 12px;
}
.nameLabel {
  xdisplay: none;
  opacity: 0;
  transition: opacity 0.3s; -webkit-transition: opacity 0.3s;
}

g:hover .nameLabel {
  xdisplay: block;
  opacity: 1;
}

.tooltip {
  display: none;
}

.x.axis path {
  display: none;
}
</style>
<script type="text/javascript" src="../lib/d3.v3.min.js"></script>
<script type="text/javascript" src="../js/fields.js"></script>
<script type="text/javascript" src="DataSet.js"></script>
<script type="text/javascript">

var w = window.innerWidth;
var h = window.innerHeight*0.7;
var svg;
var mapSVG = '../data/United_Kingdom_Map_-_Region.svg';
var dataSet;

function init() {
  svg = d3.select('#charts').append('svg')
    .attr('width', w)
    .attr('height', h);

  loadMap();
}


function loadMap() {
  d3.xml(mapSVG, 'image/svg+xml', function(xml) {
    var svgDoc = document.importNode(xml.documentElement, true);
    var svgMap = svgDoc.getElementById('map');
    svg[0][0].appendChild(svgMap);
    var mapScale = 0.25;
    var mapMargin = 30;
    var bb = svgMap.getBoundingClientRect();
    var mapX = -bb.left * mapScale + mapMargin;
    var mapY = -bb.top * mapScale + mapMargin;
    svg.select('#map').attr('transform', 'translate(' + mapX + ',' + mapY + ') scale(' + mapScale + ',' + mapScale + ')');

    bb = svgMap.getBoundingClientRect();
    var rect = svg.append('rect');
    rect.attr('x', bb.left).attr('y', bb.top).attr('width', bb.width).attr('height', bb.height);
    rect.style('stroke', 'red');
    rect.style('fill', 'none');
  });
  loadData();
}

function loadData() {
  d3.csv('../data/TSB-data-public-sample.csv', function(error, rows) {
    dataSet = DataSet.fromArray(rows);
  });
}



window.onload = init;

</script>
</head>
<body>
  <div id="charts"></div>
</body>
</html>